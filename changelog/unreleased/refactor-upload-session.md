Bugfix: refactor upload session

We refactored the upload session code to make it reusable, kill a lot of code and save some stat requests

https://github.com/cs3org/reva/pull/4402
